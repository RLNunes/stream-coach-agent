<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <title>Stream Coach ‚Äî Documenta√ß√£o</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css" />

    <!-- Estilo base + Temas (light/dark) -->
    <style>
      /**
       * Vari√°veis de cores e espa√ßamento
       * Facilita manuten√ß√£o e consist√™ncia
       */
      :root {
        /* Cores light mode */
        --light-bg: #fff;
        --light-text: #2c3e50;
        --light-link: #42b983;
        --light-sidebar: #fff;
        --light-sidebar-text: #34495e;
        --light-btn-bg: rgba(0, 0, 0, 0.06);
        --light-btn-border: rgba(0, 0, 0, 0.08);
        
        /* Cores dark mode */
        --dark-bg: #0f172a;
        --dark-text: #e2e8f0;
        --dark-link: #93c5fd;
        --dark-sidebar: #0b1220;
        --dark-sidebar-text: #cbd5e1;
        --dark-btn-bg: rgba(255, 255, 255, 0.1);
        --dark-btn-border: rgba(255, 255, 255, 0.12);
        
        /* Espa√ßamento */
        --space-xs: 0.25rem;
        --space-sm: 0.5rem;
        --space-md: 1rem;
        --space-lg: 1.5rem;
      }

      /* Ajustes de branding na sidebar (t√≠tulo centrado + espa√ßamento) */
      .app-name-link {
        display: flex !important;
        align-items: center;
        justify-content: center;
        gap: var(--space-sm);
        padding: var(--space-md) var(--space-sm);
        margin: var(--space-xs) var(--space-sm) var(--space-md);
        border-radius: var(--space-sm);
      }

      /* Dark autom√°tico (quando n√£o h√° tema for√ßado) */
      @media (prefers-color-scheme: dark) {
        :root { color-scheme: dark; }
        body { background: var(--dark-bg); }
        .markdown-section { color: var(--dark-text); }
        .markdown-section a { color: var(--dark-link); }
        .sidebar, .sidebar ul { background: var(--dark-sidebar); }
        .sidebar a { color: var(--dark-sidebar-text); }
        .app-name-link, .app-name-link img + span { color: var(--dark-text) !important; }
        .search .results-panel { background: var(--dark-sidebar); color: var(--dark-text); }
        
        /* Bot√£o de abertura da sidebar */
        .sidebar-toggle span { background-color: var(--dark-text); }
      }

      /* Bot√£o do tema */
      .theme-toggle {
        position: fixed; 
        top: var(--space-lg); 
        right: var(--space-lg); 
        z-index: 9999;
        padding: var(--space-xs) var(--space-sm); 
        border-radius: var(--space-sm); 
        font-size: 0.875rem;
        background: var(--light-btn-bg);
        backdrop-filter: blur(6px); 
        cursor: pointer;
        border: 1px solid var(--light-btn-border);
        transition: all 0.2s ease;
      }
      @media (prefers-color-scheme: dark) {
        .theme-toggle { 
          background: var(--dark-btn-bg); 
          color: var(--dark-text); 
          border-color: var(--dark-btn-border); 
        }
      }
      
      /* Bot√£o toggle da sidebar em ambos os temas */
      .sidebar-toggle { 
        background-color: transparent; 
      }
      .sidebar-toggle span {
        transition: background-color 0.2s ease;
      }

      /* ===== Temas for√ßados (Light/Dark) ‚Äî sobrep√µem o autom√°tico ===== */
      /* Dark Mode For√ßado */
      :root[data-theme="dark"] { color-scheme: dark; }
      :root[data-theme="dark"] body { background: var(--dark-bg); }
      :root[data-theme="dark"] .markdown-section { color: var(--dark-text); }
      :root[data-theme="dark"] .markdown-section a { color: var(--dark-link); }
      :root[data-theme="dark"] .sidebar, :root[data-theme="dark"] .sidebar ul { background: var(--dark-sidebar); }
      :root[data-theme="dark"] .sidebar a { color: var(--dark-sidebar-text); }
      :root[data-theme="dark"] .app-name-link, :root[data-theme="dark"] .app-name-link img + span { color: var(--dark-text) !important; }
      :root[data-theme="dark"] .search .results-panel { background: var(--dark-sidebar); color: var(--dark-text); }
      :root[data-theme="dark"] .sidebar-toggle span { background-color: var(--dark-text); }
      :root[data-theme="dark"] .theme-toggle { 
        background: var(--dark-btn-bg); 
        color: var(--dark-text); 
        border-color: var(--dark-btn-border);
      }

      /* Light Mode For√ßado */
      :root[data-theme="light"] { color-scheme: light; }
      :root[data-theme="light"] body { background: var(--light-bg); }
      :root[data-theme="light"] .markdown-section { color: var(--light-text); }
      :root[data-theme="light"] .markdown-section a { color: var(--light-link); }
      :root[data-theme="light"] .sidebar, :root[data-theme="light"] .sidebar ul { background: var(--light-sidebar); }
      :root[data-theme="light"] .sidebar a { color: var(--light-sidebar-text); }
      :root[data-theme="light"] .app-name-link, :root[data-theme="light"] .app-name-link img + span { color: var(--light-text) !important; }
      :root[data-theme="light"] .search .results-panel { background: var(--light-sidebar); color: var(--light-text); }
      :root[data-theme="light"] .sidebar-toggle span { background-color: var(--light-text); }
      :root[data-theme="light"] .theme-toggle { 
        background: var(--light-btn-bg); 
        color: var(--light-text); 
        border-color: var(--light-btn-border);
      }
    </style>
  </head>

  <body>
    <div id="app"></div>
    <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">üåô Dark</button>

    <script>
      const PROJECT_VERSION = "0.1.0"; // atualiza quando fizeres release

      window.$docsify = {
        name: "Stream Coach ‚Äî Agent",
        repo: "RLNunes/stream-coach-agent",
        loadSidebar: true,
        subMaxLevel: 2,
        auto2top: true,
        homepage: "README.md",
        search: { paths: "auto", placeholder: "Pesquisar...", noData: "Sem resultados" },
        plugins: [
          function (hook, vm) {
            hook.afterEach(function (html, next) {
              const updated = new Date().toLocaleDateString("pt-PT", { 
                year: "numeric", 
                month: "short", 
                day: "2-digit" 
              });
              const footer = `
                <hr/>
                <footer style="font-size:14px;opacity:.8;display:flex;gap:12px;flex-wrap:wrap;align-items:center;">
                  <span>üìö Docs</span><span>‚Ä¢</span>
                  <span>Vers√£o <strong>${PROJECT_VERSION}</strong></span><span>‚Ä¢</span>
                  <span>Atualizado: ${updated}</span>
                  <span style="margin-left:auto;">
                    <a href="https://github.com/RLNunes/stream-coach-agent" target="_blank" rel="noopener">GitHub</a>
                  </span>
                </footer>`;
              next(html + footer);
            });
          },
        ],
      };
    </script>

    <!-- Toggle Light/Dark/Auto -->
    <script>
      /**
       * Gest√£o de temas (light/dark/auto)
       * Segue princ√≠pios KISS e usa localStorage para persist√™ncia
       */
      (function () {
        // Constantes
        const STORAGE_KEY = "sc-theme";        // Chave para localStorage
        const THEME_LIGHT = "light";           // Valor para tema claro
        const THEME_DARK = "dark";             // Valor para tema escuro
        const btn = document.getElementById("themeToggle");
        
        /**
         * Aplica o tema ao documento e atualiza UI
         * @param {string|null} themeName - Nome do tema ou null para auto
         */
        function applyTheme(themeName) {
          // Remove ou define o atributo data-theme no elemento raiz
          if (!themeName) {
            document.documentElement.removeAttribute("data-theme");
          } else {
            document.documentElement.setAttribute("data-theme", themeName);
          }

          // Determina se est√° em modo escuro (pelo tema for√ßado ou sistema)
          const isDarkMode = themeName 
            ? themeName === THEME_DARK
            : window.matchMedia("(prefers-color-scheme: dark)").matches;
          
          // Atualiza apar√™ncia do bot√£o
          btn.textContent = isDarkMode ? "‚òÄÔ∏è Light" : "üåô Dark";
          btn.setAttribute("aria-pressed", String(isDarkMode));
          btn.title = themeName ? `Tema: ${themeName}` : "Tema: autom√°tico";
        }

        /**
         * Define o tema e persiste em localStorage
         * @param {string|null} themeName - Nome do tema ou null para auto
         */
        function setTheme(themeName) {
          if (!themeName) {
            localStorage.removeItem(STORAGE_KEY);
          } else {
            localStorage.setItem(STORAGE_KEY, themeName);
          }
          applyTheme(themeName);
        }

        // Inicializa√ß√£o - aplica tema guardado no localStorage
        applyTheme(localStorage.getItem(STORAGE_KEY));

        // Observer para altera√ß√µes de tema do sistema (quando em auto)
        window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", () => {
          if (!localStorage.getItem(STORAGE_KEY)) {
            applyTheme(null); // Reaplica o tema auto
          }
        });

        // Event listeners
        // Clique normal - alterna entre dark/light
        btn.addEventListener("click", () => {
          const currentTheme = localStorage.getItem(STORAGE_KEY);
          const nextTheme = currentTheme === THEME_DARK ? THEME_LIGHT : THEME_DARK;
          setTheme(nextTheme);
        });

        // Clique direito - volta para modo AUTO
        btn.addEventListener("contextmenu", (e) => { 
          e.preventDefault(); 
          setTheme(null); 
        });
        
        // Clique do meio - volta para modo AUTO
        btn.addEventListener("auxclick", (e) => { 
          if (e.button === 1) setTheme(null); 
        });
      })();
    </script>

    <!-- Docsify core + search -->
    <script src="//cdn.jsdelivr.net/npm/docsify@4/lib/docsify.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/docsify@4/lib/plugins/search.min.js"></script>
  </body>
</html>