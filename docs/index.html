<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <title>Stream Coach — Documentação</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <link
      rel="stylesheet"
      href="//cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css"
    />
    <style>
      @media (prefers-color-scheme: dark) {
        :root {
          color-scheme: dark;
        }
        body {
          background: #0f172a;
        }
        .markdown-section {
          color: #e2e8f0;
        }
        .markdown-section a {
          color: #93c5fd;
        }
        .sidebar,
        .sidebar ul {
          background: #0b1220;
        }
        .sidebar a {
          color: #cbd5e1;
        }
        .app-name-link,
        .app-name-link img + span {
          color: #e2e8f0 !important;
        }
        .search .results-panel {
          background: #0b1220;
          color: #e2e8f0;
        }
      }

      .theme-toggle {
        position: fixed;
        top: 12px;
        right: 12px;
        z-index: 9999;
        padding: 6px 10px;
        border-radius: 10px;
        font-size: 13px;
        background: rgba(0, 0, 0, 0.06);
        backdrop-filter: blur(6px);
        cursor: pointer;
      }
      @media (prefers-color-scheme: dark) {
        .theme-toggle {
          background: rgba(255, 255, 255, 0.08);
          color: #e2e8f0;
        }
      }
    </style>
  </head>
  <body>
    <div id="app"></div>
    <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">
      🌙 Dark
    </button>

    <script>
      const PROJECT_VERSION = "0.1.0"; // atualiza quando fizeres release

      window.$docsify = {
        name: "Stream Coach — Agent",
        repo: "RLNunes/stream-coach-agent",
        loadSidebar: true,
        subMaxLevel: 2,
        auto2top: true,
        homepage: "README.md",
        search: {
          paths: "auto",
          placeholder: "Pesquisar...",
          noData: "Sem resultados",
        },
        plugins: [
          function (hook, vm) {
            hook.afterEach(function (html, next) {
              const updated = new Date().toLocaleDateString("pt-PT", {
                year: "numeric",
                month: "short",
                day: "2-digit",
              });
              const footer = `
            <hr/>
            <footer style="font-size:14px;opacity:.8;display:flex;gap:12px;flex-wrap:wrap;align-items:center;">
              <span>📚 Docs</span>
              <span>•</span>
              <span>Versão <strong>${PROJECT_VERSION}</strong></span>
              <span>•</span>
              <span>Atualizado: ${updated}</span>
              <span style="margin-left:auto;">
                <a href="https://github.com/RLNunes/stream-coach-agent" target="_blank" rel="noopener">GitHub</a>
              </span>
            </footer>`;
              next(html + footer);
            });
          },
        ],
      };
    </script>

    <!-- Theme toggle logic -->
    <script>
      (function () {
        const KEY = "sc-theme";
        const btn = document.getElementById("themeToggle");

        function applyTheme(t) {
          document.documentElement.dataset.theme = t || "";
          const isDark = t
            ? t === "dark"
            : window.matchMedia("(prefers-color-scheme: dark)").matches;
          btn.textContent = isDark ? "☀️ Light" : "🌙 Dark";
          btn.setAttribute("aria-pressed", String(isDark));
        }

        function setTheme(next) {
          if (!next) localStorage.removeItem(KEY);
          else localStorage.setItem(KEY, next);
          applyTheme(next);
        }

        // estado inicial
        const saved = localStorage.getItem(KEY);
        applyTheme(saved);

        // atualizar quando o sistema muda (se em auto)
        window
          .matchMedia("(prefers-color-scheme: dark)")
          .addEventListener("change", () => {
            if (!localStorage.getItem(KEY)) applyTheme(null);
          });

        // clique normal → alterna
        btn.addEventListener("click", () => {
          const cur = localStorage.getItem(KEY);
          const next = cur === "dark" ? "light" : "dark";
          setTheme(next);
        });

        // clique direito ou meio → auto
        btn.addEventListener("contextmenu", (e) => {
          e.preventDefault();
          setTheme(null);
        });
        btn.addEventListener("auxclick", (e) => {
          if (e.button === 1) setTheme(null);
        });
      })();
    </script>

    <!-- Docsify core + search -->
    <script src="//cdn.jsdelivr.net/npm/docsify@4/lib/docsify.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/docsify@4/lib/plugins/search.min.js"></script>
  </body>
</html>
