<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="UTF-8" />
    <title>Stream Coach ‚Äî Documenta√ß√£o</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css" />

    <!-- Estilo base com vari√°veis CSS e melhor organiza√ß√£o -->
    <style>
      /* Vari√°veis para facilitar manuten√ß√£o e consist√™ncia */
      :root {
        /* Cores do tema claro (padr√£o) */
        --background-color: #fff;
        --text-color: #2c3e50;
        --text-color-secondary: #34495e;
        --link-color: #42b983;
        --sidebar-bg: #fff;
        --search-bg: #fff;
        --button-bg: rgba(0,0,0,0.08);
        --button-border: rgba(0,0,0,0.12);
        --button-text: #2c3e50;
        --button-hover-bg: rgba(0,0,0,0.12);
      }

      /* Vari√°veis do tema escuro */
      [data-theme="dark"] {
        --background-color: #0f172a;
        --text-color: #e2e8f0;
        --text-color-secondary: #cbd5e1;
        --link-color: #93c5fd;
        --sidebar-bg: #0b1220;
        --search-bg: #0b1220;
        --button-bg: rgba(255,255,255,0.12);
        --button-border: rgba(255,255,255,0.18);
        --button-text: #e2e8f0;
        --button-hover-bg: rgba(255,255,255,0.18);
      }

      /* Aplica√ß√£o das vari√°veis */
      body { 
        background: var(--background-color); 
        transition: background 0.3s ease;
      }
      .markdown-section { 
        color: var(--text-color); 
      }
      .markdown-section a { 
        color: var(--link-color); 
      }
      .sidebar, .sidebar ul { 
        background: var(--sidebar-bg); 
      }
      .sidebar a { 
        color: var(--text-color-secondary); 
      }
      .app-name-link, .app-name-link img + span { 
        color: var(--text-color) !important; 
      }
      .search .results-panel { 
        background: var(--search-bg); 
        color: var(--text-color); 
      }

      /* Ajustes de branding na sidebar (t√≠tulo centrado + espa√ßamento) */
      .app-name-link {
        display: flex !important;
        align-items: center;
        justify-content: center;
        gap: 10px;
        padding: 14px 12px;
        margin: 6px 10px 12px;
        border-radius: 8px;
      }
      
      /* Centralizar verticalmente o √≠cone e texto */
      .app-name-link img {
        vertical-align: middle;
        margin-right: 6px;
      }
      
      .app-name-link span {
        vertical-align: middle;
        line-height: 28px; /* Ajusta √† altura do √≠cone */
      }

      /* Bot√£o do tema com melhor contraste */
      .theme-toggle {
        position: fixed; 
        top: 12px; 
        right: 12px; 
        z-index: 9999;
        padding: 6px 12px; 
        border-radius: 10px; 
        font-size: 13px;
        background: var(--button-bg);
        color: var(--button-text);
        backdrop-filter: blur(6px); 
        cursor: pointer;
        border: 1px solid var(--button-border);
        transition: background 0.2s ease, border-color 0.2s ease;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      }

      .theme-toggle:hover {
        background: var(--button-hover-bg);
      }

      /* Dark autom√°tico (quando n√£o h√° tema for√ßado) */
      @media (prefers-color-scheme: dark) {
        :root:not([data-theme="light"]) {
          --background-color: #0f172a;
          --text-color: #e2e8f0;
          --text-color-secondary: #cbd5e1;
          --link-color: #93c5fd;
          --sidebar-bg: #0b1220;
          --search-bg: #0b1220;
          --button-bg: rgba(255,255,255,0.12);
          --button-border: rgba(255,255,255,0.18);
          --button-text: #e2e8f0;
          --button-hover-bg: rgba(255,255,255,0.18);
        }
      }
    </style>
  </head>

  <body>
    <div id="app"></div>
    <button id="themeToggle" class="theme-toggle" aria-label="Alternar tema">üåô Dark</button>

    <script>
      const PROJECT_VERSION = "0.1.0"; // atualiza quando fizeres release

      window.$docsify = {
        name: "Stream Coach ‚Äî Agent",
        repo: "RLNunes/stream-coach-agent",
        loadSidebar: true,
        subMaxLevel: 2,
        auto2top: true,
        homepage: "README.md",
        search: { paths: "auto", placeholder: "Pesquisar...", noData: "Sem resultados" },
        plugins: [
          function (hook, vm) {
            hook.afterEach(function (html, next) {
              const updated = new Date().toLocaleDateString("pt-PT", { year: "numeric", month: "short", day: "2-digit" });
              const footer = `
                <hr/>
                <footer style="font-size:14px;opacity:.8;display:flex;gap:12px;flex-wrap:wrap;align-items:center;">
                  <span>üìö Docs</span><span>‚Ä¢</span>
                  <span>Vers√£o <strong>${PROJECT_VERSION}</strong></span><span>‚Ä¢</span>
                  <span>Atualizado: ${updated}</span>
                  <span style="margin-left:auto;">
                    <a href="https://github.com/RLNunes/stream-coach-agent" target="_blank" rel="noopener">GitHub</a>
                  </span>
                </footer>`;
              next(html + footer);
            });
          },
        ],
      };
    </script>

    <!-- Toggle Light/Dark/Auto - Corrigido e simplificado -->
    <script>
      (function () {
        // Constantes
        const KEY = "sc-theme";                 // 'light' | 'dark' | null (auto)
        const btn = document.getElementById("themeToggle");
        
        /**
         * Aplica o tema √† p√°gina
         * @param {string|null} theme - 'light', 'dark' ou null (auto)
         */
        function applyTheme(theme) {
          // Define ou remove o atributo data-theme no elemento raiz
          document.documentElement.setAttribute("data-theme", theme || "");
          
          // Determina se estamos em modo escuro para ajustar o bot√£o
          const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
          const isDark = theme === "dark" || (theme === null && prefersDark);
          
          // Atualiza o texto e estado do bot√£o
          btn.textContent = isDark ? "‚òÄÔ∏è Light" : "üåô Dark";
          btn.setAttribute("aria-pressed", String(isDark));
          btn.title = theme ? `Tema: ${theme}` : "Tema: auto";
        }

        /**
         * Define o tema e salva a prefer√™ncia
         * @param {string|null} theme - 'light', 'dark' ou null (auto)
         */
        function setTheme(theme) {
          // Salva a prefer√™ncia do usu√°rio
          if (!theme) {
            localStorage.removeItem(KEY);
          } else {
            localStorage.setItem(KEY, theme);
          }
          
          // Aplica o tema
          applyTheme(theme);
        }

        // Inicializa√ß√£o: aplica o tema salvo ou o tema autom√°tico
        applyTheme(localStorage.getItem(KEY));

        // Atualiza quando a prefer√™ncia do sistema muda (se estiver em modo autom√°tico)
        window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", (e) => {
          if (!localStorage.getItem(KEY)) {
            applyTheme(null);
          }
        });

        // Clique normal ‚Üí alterna entre dark/light
        btn.addEventListener("click", () => {
          const currentTheme = localStorage.getItem(KEY);
          const nextTheme = currentTheme === "dark" ? "light" : "dark";
          setTheme(nextTheme);
        });

        // Clique direito ou clique do meio ‚Üí volta a AUTO
        btn.addEventListener("contextmenu", (e) => { 
          e.preventDefault(); 
          setTheme(null); 
        });
        
        btn.addEventListener("auxclick", (e) => { 
          if (e.button === 1) {
            setTheme(null); 
          }
        });
      })();
    </script>

    <!-- Docsify core + search -->
    <script src="//cdn.jsdelivr.net/npm/docsify@4/lib/docsify.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/docsify@4/lib/plugins/search.min.js"></script>
  </body>
</html>